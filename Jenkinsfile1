def readprop
def failed_stage
currentBuild.displayName = "Integrate-#"+currentBuild.number
pipeline {
    agent any
    stages {
        stage ('Setup') {
            steps {
                script{
                    readprop = readFile 'testconfig.properties'
                    failed_stage = env.STAGE_NAME
                    Setup = "{readprop['Setup']}"
                    if ("$Setup" == "yes") {
                        sh "git config --global user.email neer90k@gmail.com"
                        sh "git config --global user.name ${readProb['user.name']}"
	                    sh 'git config --global credential.helper cache'
	                    sh 'git config --global credential.helper cache'
	                    sh "if [ -d ${readprop['Project_name']} ]; then rm -Rf ${readprop['Project_name']}; fi"
	                    sh "if [ -d ${readprop['PMD_result']} ]; then rm -Rf ${readprop['PMD_result']};  fi"        
	                    sh "mkdir ${readprop['PMD_result']}"
			}
			else {
			 echo "Skipped stage"
                    }
                    
                }
                
            }
            
        }
        
    }
}
